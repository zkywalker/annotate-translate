# âŒ é”™è¯¯ä¿®å¤æŒ‡å—

## é”™è¯¯ï¼šCould not establish connection. Receiving end does not exist.

### ğŸ¯ è¿™ä¸ªé”™è¯¯æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

è¿™ä¸ªé”™è¯¯è¡¨ç¤ºï¼š
- âœ‰ï¸ Background script è¯•å›¾å‘é¡µé¢å‘é€æ¶ˆæ¯
- âŒ ä½†é¡µé¢ä¸­æ²¡æœ‰ Content Script åœ¨ç›‘å¬
- ğŸ”§ Content Script æ²¡æœ‰è¢«æ³¨å…¥åˆ°å½“å‰é¡µé¢

### ğŸ› ï¸ ä¿®å¤æ­¥éª¤ï¼ˆæŒ‰é¡ºåºæ‰§è¡Œï¼‰

#### âœ… æ­¥éª¤ 1: é‡æ–°åŠ è½½æ’ä»¶
```
1. æ‰“å¼€ chrome://extensions/
2. æ‰¾åˆ° "Annotate Translate" æ’ä»¶
3. ç‚¹å‡»åˆ·æ–°å›¾æ ‡ ğŸ”„
4. ç¡®è®¤æ’ä»¶çŠ¶æ€ä¸º"å·²å¯ç”¨"
```

#### âœ… æ­¥éª¤ 2: åˆ·æ–°æµ‹è¯•é¡µé¢
```
1. å›åˆ°ä½ çš„æµ‹è¯•é¡µé¢
2. æŒ‰ F5 æˆ– Ctrl+R åˆ·æ–°é¡µé¢
3. ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½
```

#### âœ… æ­¥éª¤ 3: éªŒè¯ Content Script å·²åŠ è½½
```
1. åœ¨é¡µé¢ä¸ŠæŒ‰ F12 æ‰“å¼€ DevTools
2. åˆ‡æ¢åˆ° Console æ ‡ç­¾
3. åº”è¯¥çœ‹åˆ°æ—¥å¿—ï¼š
   "[Annotate-Translate] Content script loaded on: [é¡µé¢URL]"
   "[Annotate-Translate] Settings loaded: {...}"
```

#### âœ… æ­¥éª¤ 4: æµ‹è¯•åŠŸèƒ½
```
1. åœ¨é¡µé¢ä¸Šé€‰ä¸­ä¸€äº›æ–‡å­—
2. å³é”®ç‚¹å‡»
3. é€‰æ‹© "Annotate [é€‰ä¸­çš„æ–‡å­—]"
4. è¾“å…¥æ ‡æ³¨æ–‡æœ¬
5. æŸ¥çœ‹æ•ˆæœ
```

### ğŸ” ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé”™è¯¯ï¼Ÿ

**ä¸»è¦åŸå› ï¼š**

1. **é¡µé¢åœ¨æ’ä»¶åŠ è½½å‰å°±å·²ç»æ‰“å¼€**
   - Content Script åªæ³¨å…¥åˆ°**æ–°åŠ è½½çš„é¡µé¢**
   - å·²ç»æ‰“å¼€çš„é¡µé¢éœ€è¦**æ‰‹åŠ¨åˆ·æ–°**

2. **æ’ä»¶åˆšåˆšæ›´æ–°/é‡æ–°åŠ è½½**
   - æ›´æ–°æ’ä»¶åï¼Œæ‰€æœ‰å·²æ‰“å¼€çš„é¡µé¢éƒ½éœ€è¦åˆ·æ–°
   - åˆ·æ–°å Content Script æ‰ä¼šé‡æ–°æ³¨å…¥

3. **æŸäº›ç‰¹æ®Šé¡µé¢ä¸å…è®¸æ³¨å…¥**
   - Chromeå†…éƒ¨é¡µé¢ï¼ˆchrome://...ï¼‰
   - Chrome Web Store é¡µé¢
   - æ–°æ ‡ç­¾é¡µï¼ˆNew Tabï¼‰
   - è§£å†³æ–¹æ³•ï¼šåœ¨æ™®é€šç½‘é¡µä¸Šæµ‹è¯•

### ğŸ†• å·²æ·»åŠ çš„è‡ªåŠ¨ä¿®å¤åŠŸèƒ½

æœ€æ–°ç‰ˆæœ¬å·²ç»æ·»åŠ äº†**è‡ªåŠ¨æ³¨å…¥æœºåˆ¶**ï¼š

```javascript
// ç°åœ¨æ’ä»¶ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶æ³¨å…¥ Content Script
// ä½†é¦–æ¬¡ä½¿ç”¨æ—¶ä»å»ºè®®åˆ·æ–°é¡µé¢ä»¥ç¡®ä¿ç¨³å®š
```

**å·¥ä½œåŸç†ï¼š**
1. ç”¨æˆ·ç‚¹å‡»å³é”®èœå•
2. Background Script å…ˆå‘é€ "ping" æ¶ˆæ¯æ£€æµ‹
3. å¦‚æœæ²¡æœ‰å“åº”ï¼Œè‡ªåŠ¨æ³¨å…¥ Content Script
4. ç„¶åå†å‘é€å®é™…çš„åŠŸèƒ½æ¶ˆæ¯

**æ³¨æ„ï¼š** è™½ç„¶æœ‰è‡ªåŠ¨æ³¨å…¥ï¼Œä½†**åˆ·æ–°é¡µé¢ä»æ˜¯æœ€å¯é çš„æ–¹å¼**ï¼

### ğŸ“‹ å®Œæ•´çš„æ•…éšœæ’é™¤æ¸…å•

- [ ] æ’ä»¶å·²åœ¨ `chrome://extensions/` ä¸­å¯ç”¨
- [ ] å¼€å‘è€…æ¨¡å¼å·²å¼€å¯
- [ ] æ’ä»¶å·²é‡æ–°åŠ è½½ï¼ˆç‚¹å‡»åˆ·æ–°ğŸ”„ï¼‰
- [ ] æµ‹è¯•é¡µé¢å·²åˆ·æ–°ï¼ˆæŒ‰F5ï¼‰
- [ ] ä¸æ˜¯åœ¨ Chrome ç‰¹æ®Šé¡µé¢ä¸Šæµ‹è¯•
- [ ] DevTools Console ä¸­èƒ½çœ‹åˆ° Content Script åŠ è½½æ—¥å¿—
- [ ] Service Worker Console ä¸­èƒ½çœ‹åˆ°èœå•ç‚¹å‡»æ—¥å¿—
- [ ] manifest.json ä¸­åŒ…å« "scripting" æƒé™
- [ ] content.js å’Œ content.css æ–‡ä»¶å­˜åœ¨

### ğŸ§ª å¿«é€ŸéªŒè¯è„šæœ¬

åœ¨é¡µé¢çš„ Console ä¸­æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼Œæ£€æŸ¥ Content Script æ˜¯å¦å­˜åœ¨ï¼š

```javascript
// æ£€æŸ¥ Content Script æ˜¯å¦æ³¨å…¥
chrome.runtime.sendMessage({action: 'ping'}, (response) => {
  if (chrome.runtime.lastError) {
    console.error('âŒ Content Script æœªæ³¨å…¥:', chrome.runtime.lastError.message);
  } else if (response && response.pong) {
    console.log('âœ… Content Script å·²æ­£å¸¸åŠ è½½');
  }
});
```

### ğŸ“ å­¦åˆ°çš„çŸ¥è¯†ç‚¹

1. **Content Script æ³¨å…¥æ—¶æœº**
   - é¡µé¢åŠ è½½æ—¶ï¼ˆç”± manifest.json é…ç½®ï¼‰
   - æˆ–è€…é€šè¿‡ `chrome.scripting.executeScript()` åŠ¨æ€æ³¨å…¥

2. **Manifest V3 çš„å˜åŒ–**
   - éœ€è¦ `scripting` æƒé™æ‰èƒ½åŠ¨æ€æ³¨å…¥
   - Service Worker æ›¿ä»£äº† Background Page

3. **æ¶ˆæ¯ä¼ é€’æœºåˆ¶**
   - Background â†”ï¸ Content Script é€šè¿‡ `chrome.tabs.sendMessage()`
   - éœ€è¦ç¡®ä¿æ¥æ”¶æ–¹å­˜åœ¨å¹¶åœ¨ç›‘å¬

4. **æœ€ä½³å®è·µ**
   - æ€»æ˜¯æ·»åŠ é”™è¯¯å¤„ç†
   - æ·»åŠ æ—¥å¿—ä¾¿äºè°ƒè¯•
   - æä¾›ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

---

## å…¶ä»–å¸¸è§é”™è¯¯

### é”™è¯¯ï¼šCannot access contents of url "chrome://..."

**åŸå› ï¼š** Chrome ä¸å…è®¸åœ¨å†…éƒ¨é¡µé¢æ³¨å…¥ Content Script

**è§£å†³ï¼š** åœ¨æ™®é€šç½‘é¡µä¸Šæµ‹è¯•ï¼ˆå¦‚ test.html æˆ–ä»»ä½•ç½‘ç«™ï¼‰

### é”™è¯¯ï¼šExtension context invalidated

**åŸå› ï¼š** æ’ä»¶è¢«é‡æ–°åŠ è½½ï¼Œæ—§çš„ä¸Šä¸‹æ–‡å·²å¤±æ•ˆ

**è§£å†³ï¼š** åˆ·æ–°æ‰€æœ‰ä½¿ç”¨æ’ä»¶çš„é¡µé¢

### é”™è¯¯ï¼šCannot read properties of undefined

**åŸå› ï¼š** å¯¹è±¡æˆ–å˜é‡æœªæ­£ç¡®åˆå§‹åŒ–

**è§£å†³ï¼š** æ£€æŸ¥ Console æ—¥å¿—ï¼ŒæŸ¥çœ‹å…·ä½“æ˜¯å“ªä¸ªå˜é‡

---

## ğŸ“ ä»ç„¶æœ‰é—®é¢˜ï¼Ÿ

1. æŸ¥çœ‹ Service Worker Consoleï¼šæœ‰æ— é”™è¯¯ä¿¡æ¯ï¼Ÿ
2. æŸ¥çœ‹é¡µé¢ Consoleï¼šContent Script æ˜¯å¦åŠ è½½ï¼Ÿ
3. æ£€æŸ¥ Network æ ‡ç­¾ï¼šèµ„æºæ˜¯å¦æ­£ç¡®åŠ è½½ï¼Ÿ
4. æŸ¥çœ‹ Elements æ ‡ç­¾ï¼šDOM æ˜¯å¦æ­£ç¡®ä¿®æ”¹ï¼Ÿ

è®°ä½ï¼š**åˆ·æ–°é¡µé¢é€šå¸¸èƒ½è§£å†³ 90% çš„é—®é¢˜ï¼** ğŸ”„

---

ç”Ÿæˆæ—¶é—´: 2025-10-11
ç‰ˆæœ¬: ä¿®å¤äº† "Receiving end does not exist" é”™è¯¯
