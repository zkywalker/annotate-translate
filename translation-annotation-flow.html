<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Translation & Annotation Architecture Flow</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 40px 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      color: white;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 36px;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 16px;
      opacity: 0.9;
    }

    .flow-container {
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      margin-bottom: 30px;
    }

    .flow-title {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 30px;
      color: #333;
      text-align: center;
    }

    .flow-stage {
      margin-bottom: 20px;
    }

    .stage-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .stage-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 15px;
      padding: 0 10px;
    }

    .box {
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      padding: 16px;
      position: relative;
    }

    .box.shared {
      background: #e8f5e9;
      border-color: #4caf50;
    }

    .box.different {
      background: #fff3e0;
      border-color: #ff9800;
    }

    .box h3 {
      font-size: 14px;
      margin-bottom: 8px;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .box .content {
      font-size: 14px;
      color: #333;
      line-height: 1.6;
    }

    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      margin-left: 8px;
    }

    .badge-shared {
      background: #4caf50;
      color: white;
    }

    .badge-partial {
      background: #ff9800;
      color: white;
    }

    .arrow {
      text-align: center;
      font-size: 24px;
      color: #667eea;
      margin: 10px 0;
    }

    .data-structure {
      background: #f8f9fa;
      border: 2px solid #667eea;
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
    }

    .data-structure h3 {
      color: #667eea;
      margin-bottom: 15px;
      font-size: 18px;
    }

    .data-structure pre {
      background: #2d2d2d;
      color: #f8f9fa;
      padding: 15px;
      border-radius: 6px;
      overflow-x: auto;
      font-size: 13px;
      line-height: 1.6;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .stat-card {
      background: white;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .stat-card .icon {
      font-size: 48px;
      margin-bottom: 12px;
    }

    .stat-card .value {
      font-size: 32px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 8px;
    }

    .stat-card .label {
      font-size: 14px;
      color: #666;
    }

    .legend {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 30px 0;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .legend-box {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      border: 2px solid;
    }

    .legend-box.shared {
      background: #e8f5e9;
      border-color: #4caf50;
    }

    .legend-box.different {
      background: #fff3e0;
      border-color: #ff9800;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ—ï¸ Translation & Annotation Architecture</h1>
      <p>å…±äº«åŸºç¡€è®¾æ–½ï¼Œå·®å¼‚åŒ–UIæ¸²æŸ“</p>
    </div>

    <div class="flow-container">
      <div class="flow-title">æ•°æ®æµç¨‹</div>

      <div class="legend">
        <div class="legend-item">
          <div class="legend-box shared"></div>
          <span>âœ… å®Œå…¨å…±äº«</span>
        </div>
        <div class="legend-item">
          <div class="legend-box different"></div>
          <span>âš ï¸ éƒ¨åˆ†å…±äº«æˆ–å·®å¼‚åŒ–</span>
        </div>
      </div>

      <!-- Stage 1: User Input -->
      <div class="flow-stage">
        <div class="stage-header">
          <span>ğŸ“</span> Stage 1: ç”¨æˆ·è¾“å…¥
        </div>
        <div class="stage-content">
          <div class="box">
            <h3>ç¿»è¯‘åŠŸèƒ½</h3>
            <div class="content">
              â€¢ ç”¨æˆ·é€‰ä¸­æ–‡æœ¬<br>
              â€¢ ç‚¹å‡» "T" æŒ‰é’®<br>
              â€¢ è§¦å‘ <code>translateText()</code>
            </div>
          </div>
          <div class="box">
            <h3>æ³¨é‡ŠåŠŸèƒ½</h3>
            <div class="content">
              â€¢ ç”¨æˆ·é€‰ä¸­æ–‡æœ¬<br>
              â€¢ ç‚¹å‡» "A" æŒ‰é’®<br>
              â€¢ è§¦å‘ <code>annotateSelectedText()</code>
            </div>
          </div>
        </div>
      </div>

      <div class="arrow">â¬‡ï¸</div>

      <!-- Stage 2: Translation Service -->
      <div class="flow-stage">
        <div class="stage-header">
          <span>ğŸ”„</span> Stage 2: ç¿»è¯‘æœåŠ¡
          <span class="badge badge-shared">100% å…±äº«</span>
        </div>
        <div class="stage-content">
          <div class="box shared" style="grid-column: 1 / -1;">
            <h3>TranslationService.translate()</h3>
            <div class="content">
              <strong>ä¸¤ä¸ªåŠŸèƒ½éƒ½è°ƒç”¨åŒä¸€ä¸ªæ–¹æ³•ï¼š</strong><br>
              â€¢ å‚æ•°ç›¸åŒï¼štext, targetLanguage, sourceLang<br>
              â€¢ ç¼“å­˜ç­–ç•¥ç›¸åŒ<br>
              â€¢ æä¾›å•†é€‰æ‹©ç›¸åŒ<br>
              â€¢ è¿”å›æ•°æ®ç»“æ„ç›¸åŒ
            </div>
          </div>
        </div>
      </div>

      <div class="arrow">â¬‡ï¸</div>

      <!-- Stage 3: Cache -->
      <div class="flow-stage">
        <div class="stage-header">
          <span>ğŸ’¾</span> Stage 3: ç¼“å­˜æ£€æŸ¥
          <span class="badge badge-shared">100% å…±äº«</span>
        </div>
        <div class="stage-content">
          <div class="box shared" style="grid-column: 1 / -1;">
            <h3>ç»Ÿä¸€ç¼“å­˜æœºåˆ¶</h3>
            <div class="content">
              â€¢ Cache Key: <code>${text}:${sourceLang}:${targetLang}:${provider}</code><br>
              â€¢ LRU ç­–ç•¥ï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰<br>
              â€¢ å¯é…ç½®å¤§å°ï¼ˆ10-1000 é¡¹ï¼‰<br>
              â€¢ <strong>ç¿»è¯‘å’Œæ³¨é‡Šå…±äº«åŒä¸€ä¸ªç¼“å­˜æ± </strong>
            </div>
          </div>
        </div>
      </div>

      <div class="arrow">â¬‡ï¸</div>

      <!-- Stage 4: Provider -->
      <div class="flow-stage">
        <div class="stage-header">
          <span>ğŸŒ</span> Stage 4: ç¿»è¯‘æä¾›å•†
          <span class="badge badge-shared">100% å…±äº«</span>
        </div>
        <div class="stage-content">
          <div class="box shared">
            <h3>Debug Provider</h3>
            <div class="content">
              â€¢ è¿”å›æµ‹è¯•æ•°æ®<br>
              â€¢ åŒ…å«å®Œæ•´çš„éŸ³æ ‡ã€è¯ä¹‰ã€ä¾‹å¥<br>
              â€¢ æ”¯æŒ annotationText ç”Ÿæˆ
            </div>
          </div>
          <div class="box shared">
            <h3>Youdao Provider</h3>
            <div class="content">
              â€¢ è°ƒç”¨æœ‰é“ API<br>
              â€¢ è§£æéŸ³æ ‡ã€è¯ä¹‰ã€ä¾‹å¥<br>
              â€¢ éŸ³æ ‡è¡¥å……æœºåˆ¶ï¼ˆFreeDictionaryï¼‰
            </div>
          </div>
          <div class="box shared">
            <h3>Google Provider</h3>
            <div class="content">
              â€¢ è°ƒç”¨ Google Translate<br>
              â€¢ åŸºç¡€ç¿»è¯‘åŠŸèƒ½<br>
              â€¢ å¯æ‰©å±•éŸ³æ ‡æ”¯æŒ
            </div>
          </div>
        </div>
      </div>

      <div class="arrow">â¬‡ï¸</div>

      <!-- Stage 5: TranslationResult -->
      <div class="flow-stage">
        <div class="stage-header">
          <span>ğŸ“¦</span> Stage 5: æ•°æ®ç»“æ„
          <span class="badge badge-shared">100% å…±äº«</span>
        </div>
        <div class="data-structure">
          <h3>TranslationResult (ä¸¤ä¸ªåŠŸèƒ½æ”¶åˆ°ç›¸åŒçš„æ•°æ®)</h3>
          <pre>{
  originalText: "technique",
  translatedText: "æŠ€æœ¯",
  sourceLang: "en",
  targetLang: "zh-CN",
  
  <span style="color: #4caf50;">// âœ… éŸ³æ ‡æ•°æ®ï¼ˆå…±äº«ï¼‰</span>
  phonetics: [
    { text: "/tekËˆniËk/", type: "us", audioUrl: "..." },
    { text: "/tekËˆniËk/", type: "uk", audioUrl: "..." }
  ],
  
  <span style="color: #4caf50;">// âœ… è¯ä¹‰æ•°æ®ï¼ˆå…±äº«ï¼‰</span>
  definitions: [
    { partOfSpeech: "n.", text: "æŠ€æœ¯ï¼›æŠ€å·§", synonyms: ["method", "skill"] }
  ],
  
  <span style="color: #4caf50;">// âœ… ä¾‹å¥æ•°æ®ï¼ˆå…±äº«ï¼‰</span>
  examples: [
    { source: "Practice makes perfect", translation: "ç†Ÿèƒ½ç”Ÿå·§" }
  ],
  
  <span style="color: #4caf50;">// âœ… æ ‡æ³¨æ–‡æœ¬ï¼ˆå…±äº«ï¼Œä¸“ä¸ºæ³¨é‡ŠåŠŸèƒ½ç”Ÿæˆï¼‰</span>
  annotationText: "/tekËˆniËk/ æŠ€æœ¯",
  
  provider: "Youdao Translate",
  timestamp: 1697123456789
}</pre>
        </div>
      </div>

      <div class="arrow">â¬‡ï¸</div>

      <!-- Stage 6: UI Rendering -->
      <div class="flow-stage">
        <div class="stage-header">
          <span>ğŸ¨</span> Stage 6: UI æ¸²æŸ“
          <span class="badge badge-partial">å·®å¼‚åŒ–è®¾è®¡</span>
        </div>
        <div class="stage-content">
          <div class="box different">
            <h3>ç¿»è¯‘åŠŸèƒ½ UI</h3>
            <div class="content">
              <strong>TranslationUI.render(result)</strong><br><br>
              âœ… åŸæ–‡ï¼ˆoriginalTextï¼‰<br>
              âœ… è¯‘æ–‡ï¼ˆtranslatedTextï¼‰<br>
              âœ… è¯»éŸ³ï¼ˆphonetics[]ï¼‰- å®Œæ•´åˆ—è¡¨<br>
              âœ… è¯ä¹‰ï¼ˆdefinitions[]ï¼‰- å…¨éƒ¨æ˜¾ç¤º<br>
              âœ… ä¾‹å¥ï¼ˆexamples[]ï¼‰- å…¨éƒ¨æ˜¾ç¤º<br>
              âœ… æä¾›å•†ï¼ˆproviderï¼‰<br>
              âœ… å…³é—­æŒ‰é’®<br><br>
              <strong>å½¢å¼ï¼š</strong>æ‚¬æµ®å¡ç‰‡ï¼ˆTooltipï¼‰
            </div>
          </div>
          <div class="box different">
            <h3>æ³¨é‡ŠåŠŸèƒ½ UI</h3>
            <div class="content">
              <strong>createRubyAnnotation(result)</strong><br><br>
              âœ… æ ‡æ³¨æ–‡æœ¬ï¼ˆannotationTextï¼‰<br>
              âœ… éŸ³é¢‘æŒ‰é’®ï¼ˆå¦‚æœæœ‰ phoneticsï¼‰<br>
              âŒ ä¸æ˜¾ç¤ºè¯ä¹‰ï¼ˆç©ºé—´é™åˆ¶ï¼‰<br>
              âŒ ä¸æ˜¾ç¤ºä¾‹å¥ï¼ˆç©ºé—´é™åˆ¶ï¼‰<br><br>
              <strong>å½¢å¼ï¼š</strong>å†…è” Ruby æ ‡ç­¾<br>
              <code>&lt;ruby&gt;technique&lt;rt&gt;/tekËˆniËk/ æŠ€æœ¯ ğŸ”Š&lt;/rt&gt;&lt;/ruby&gt;</code>
            </div>
          </div>
        </div>
      </div>

      <div class="arrow">â¬‡ï¸</div>

      <!-- Stage 7: Audio -->
      <div class="flow-stage">
        <div class="stage-header">
          <span>ğŸ”Š</span> Stage 7: éŸ³é¢‘æ’­æ”¾
          <span class="badge badge-partial">70% å…±äº«</span>
        </div>
        <div class="stage-content">
          <div class="box shared">
            <h3>å…±äº«éƒ¨åˆ†</h3>
            <div class="content">
              âœ… ç›¸åŒçš„ phonetics æ•°æ®æº<br>
              âœ… ç›¸åŒçš„éŸ³é¢‘ URL/æ•°æ®<br>
              âœ… éƒ½æ”¯æŒ Web Speech APIï¼ˆTTSï¼‰<br>
              âœ… éƒ½ä½¿ç”¨ LRU ç¼“å­˜ç­–ç•¥
            </div>
          </div>
          <div class="box different">
            <h3>å®ç°å·®å¼‚</h3>
            <div class="content">
              âš ï¸ ç¿»è¯‘ï¼šTranslationUI å†…çš„å®ç°<br>
              âš ï¸ æ³¨é‡Šï¼šcontent.js å†…çš„ç‹¬ç«‹å®ç°<br>
              âš ï¸ å„è‡ªç»´æŠ¤ç‹¬ç«‹çš„éŸ³é¢‘ç¼“å­˜<br><br>
              <strong>å¯ä¼˜åŒ–ï¼š</strong>ç»Ÿä¸€åˆ°å…±äº«çš„ AudioService
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Stats -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="icon">ğŸ”„</div>
        <div class="value">100%</div>
        <div class="label">ç¿»è¯‘æœåŠ¡å…±äº«</div>
      </div>
      <div class="stat-card">
        <div class="icon">ğŸ’¾</div>
        <div class="value">100%</div>
        <div class="label">ç¼“å­˜æœºåˆ¶å…±äº«</div>
      </div>
      <div class="stat-card">
        <div class="icon">ğŸ“¦</div>
        <div class="value">100%</div>
        <div class="label">æ•°æ®ç»“æ„å…±äº«</div>
      </div>
      <div class="stat-card">
        <div class="icon">ğŸµ</div>
        <div class="value">100%</div>
        <div class="label">éŸ³æ ‡æ•°æ®å…±äº«</div>
      </div>
      <div class="stat-card">
        <div class="icon">ğŸ”Š</div>
        <div class="value">70%</div>
        <div class="label">éŸ³é¢‘æ’­æ”¾å…±äº«</div>
      </div>
      <div class="stat-card">
        <div class="icon">â­</div>
        <div class="value">95%</div>
        <div class="label">æ€»ä½“å…±äº«åº¦</div>
      </div>
    </div>
  </div>

  <script>
    // Add smooth animations
    document.addEventListener('DOMContentLoaded', () => {
      const boxes = document.querySelectorAll('.box');
      boxes.forEach((box, index) => {
        box.style.opacity = '0';
        box.style.transform = 'translateY(20px)';
        setTimeout(() => {
          box.style.transition = 'all 0.3s ease-out';
          box.style.opacity = '1';
          box.style.transform = 'translateY(0)';
        }, index * 50);
      });
    });
  </script>
</body>
</html>

